<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animated Historical US Boundaries</title>
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.css" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata">
    <script src="https://api.mapbox.com/mapbox.js/plugins/turf/v3.0.11/turf.min.js"></script>
    <style>
        body { margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; font-family: 'Calibri', sans-serif; }
        #title {
            margin-top: 20px;
            margin-left: 350px; /* Adjust this value as needed */
            font-size: 24px;
            font-weight: bold;
            color: black;
            font-family: 'Inconsolata', sans-serif;
            text-shadow: 1px 1px 1px grey, -1px -1px 1px grey, 1px -1px 1px grey, -1px 1px 1px grey;
        }
        #container {
            display: flex;
            width: 100%;
            height: calc(80vh - 20px);
            margin-top: 20px;
        }
        #text-section {
            flex: 0.3;
            padding: 20px;
            background-color: lightgrey;
            overflow-y: auto;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            font-family: 'Inconsolata', sans-serif;
            text-align: justify;
        }
        #map { flex: 1; }
        #slider {
            width: 50%;
            margin: 20px auto;
            margin-left: 550px; /* Adjust this value as needed */

            display: block;
            -webkit-appearance: none;
            appearance: none;
            height: 10px;
            background: #ddd;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
        }
        #slider:hover {
            opacity: 1;
        }
        #slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 10px;
            height: 20px;
            background: black;
            cursor: pointer;
            border-radius: 50%;
        }
        #slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            background: #151615;
            cursor: pointer;
            border-radius: 50%;
        }
        #year-label {
            margin-top: -15px;
            margin-left: 400px; /* Adjust this value as needed */

            font-size: 15px;
            background-color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-family: 'Open Sans Bold', 'Arial Unicode MS Bold';
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: black;
            text-shadow: 1px 1px 1px gray, -1px -1px 1px gray, 1px -1px 1px gray, -1px 1px 1px gray;
        }
    </style>
</head>
<body>
    <div id="title">THE TERRITORIAL EXPANSION OF THE CONTIGUOUS UNITED STATES</div>
    <div id="container">
        <div id="text-section">
            <p>
                 During the 17th and 18th centuries, there were thirteen British colonies on the Atlantic coast of North America. Grievances against the imperial government led the 13 colonies to begin uniting in 1774, and expelling British officials by 1775.</p>
            
                <img src="colonies.png" alt="Thirteen colonies" style="width: 300px; height: auto; margin-bottom: 20px">
      <p>
                
               By 1800, states and territories of the United States used in the second census included Kentucky and Tennessee as well as the NorthWest territories and the territories of Indiana and Mississipi.
              In 1803, the United States acquired the louisiana territory from Spain fulfilling the concept of Manifest Destiny which further fueled westward migration, with pioneers and settlers moving across the Appalachian Mountains to settle areas like the Midwest, Great Plains, and eventually the West Coast. In 1804, the territory was 
            divided into the Orleans Territory and the Louisiana District. The territoty of Orleans was admitted into the Union as the state of Louisiana in 1812. To avoid confusion, the northern part 
            of Louisiana territory was renamed Missouri Territory.The Louisiana purchase doubled the size of the United states.</p>
            <img src="Louisiana_Purchase.png" alt="Louisiana Purchase" style="width: 300px; height: auto; margin-bottom: 20px";>
            <p> In 1821, the Adams-Onis Treaty between the US and new Spain aquired West Florida to the US setting a boundary between US and New Spain, now Mwxico. In 1846, the Oregon treaty between the United states and Britain was signed. Two years after, the US made Oregon a territory which included all of the present day states of Oregon, Washington, Idaho, and parts of Montana and Wyoming.</p>
            
            <p> Texas was annexed from the Republic of Texas after it claimed independence from Mexico in 1836. This annexation occurred in 1845</p>
                  
            <p> The  Treaty of Guadalupe, signed on February 2, 1848, ended the war between the United States and Mexico. By its terms, Mexico ceded 55% of its territory, including the present-day states California, Nevada, Utah, New Mexico, most of Arizona and Colorado, and parts of Oklahoma, Kansas, and Wyoming. This region was referred to as Mexican Cession. Mexican residents in the newly acquired territories were given the option to relocate within Mexico's new boundaries or to stay and become U.S. citizens</p>
            <img src="mexican_war.png" alt="Mexican War" style="width: 300px; height: auto; margin-bottom: 20px";>
            <p> In 1854, the Gadsen Purchase saw the aquisition of present day southern Arizona and south Western New Mexico by the United States.</p>
            <p> By 1866, part of the western half of the Indian Territory was claimed by the United states and later became Oklahoma territory in 1890.</p>
            <p> In 1912, the United States officially had 48 states with the Addition of Arizona and New Mexico.</p>


        </div>
        <div id="map"></div>
    </div>
    <input type="range" id="slider" min="1800" max="1910" step="10" value="1800">
    <div id="year-label">Year: 1800</div>
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.12.0/mapbox-gl.js"></script>
    <script>
        mapboxgl.accessToken = 'pk.eyJ1Ijoibndhamlha3UiLCJhIjoiY2x3amphbXZ2MG02YTJscDRmcXE3MDllZCJ9.RwnwQjJ1U0Y95kTvA-4i7g'; // Replace with your Mapbox access token

        const map = new mapboxgl.Map({
            container: 'map',
            style: {
                "version": 8,
                "sources": {
                    "esriWorldPhysical": {
                        "type": "raster",
                        "tiles": [
                            "https://server.arcgisonline.com/ArcGIS/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}"
                        ],
                        "tileSize": 256,
                        "attribution": 'Esri, HERE, Garmin, FAO, NOAA, USGS, Intermap, METI, Â© OpenStreetMap contributors, and the GIS User Community'
                    }
                },
                "glyphs": "mapbox://fonts/mapbox/{fontstack}/{range}.pbf",
                "layers": [
                    {
                        "id": "esriWorldPhysical-layer",
                        "type": "raster",
                        "source": "esriWorldPhysical",
                        "minzoom": 0,
                        "maxzoom": 22
                    }
                ]
            },
            center: [-98.35, 39.50],
            zoom: 4
        });

        const shapefiles = {
            1800: 'states1800.json',
            1810: 'states1810.json',
            1820: 'states1820.json',
            1830: 'states1830.json',
            1840: 'states1840.json',
            1850: 'states1850.json',
            1860: 'states1860.json',
            1870: 'states1870.json',
            1880: 'states1880.json',
            1890: 'states1890.json',
            1900: 'state1900.geojson',
            1910: 'states1920.geojson',



        };

        function getNameField(data) {
            const possibleFields = ['STATENAM', 'STATE_ABBR', 'LABEL'];
            const properties = data.features[0].properties;
            for (let field of possibleFields) {
                if (properties.hasOwnProperty(field)) {
                    return field;
                }
            }
            return 'name'; // Fallback if no match is found
        }

        function getCentroid(geometry) {
            if (geometry.type === "Polygon") {
                return turf.centroid(geometry).geometry.coordinates;
            } else if (geometry.type === "MultiPolygon") {
                let largestPolygon = geometry.coordinates.reduce((a, b) => {
                    return turf.area(turf.polygon(a)) > turf.area(turf.polygon(b)) ? a : b;
                });
                return turf.centroid(turf.polygon(largestPolygon)).geometry.coordinates;
            }
        }

        function prepareLabelData(data, nameField) {
            const labelFeatures = data.features.map(feature => {
                const centroid = getCentroid(feature.geometry);
                return {
                    type: "Feature",
                    properties: {
                        name: feature.properties[nameField]
                    },
                    geometry: {
                        type: "Point",
                        coordinates: centroid
                    }
                };
            });
            return {
                type: "FeatureCollection",
                features: labelFeatures
            };
        }

        function loadShapefile(year) {
            const url = shapefiles[year];
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    const nameField = getNameField(data);
                    const labelData = prepareLabelData(data, nameField);
                    if (map.getSource('us-boundaries')) {
                        map.getSource('us-boundaries').setData(data);
                        map.getSource('us-boundaries-labels').setData(labelData);
                    } else {
                        map.addSource('us-boundaries', {
                            type: 'geojson',
                            data: data
                        });
                        map.addLayer({
                            id: 'us-boundaries-layer',
                            type: 'fill',
                            source: 'us-boundaries',
                            layout: {},
                            paint: {
                                'fill-color': 'lightgrey', // Changed fill color to light grey
                                'fill-outline-color': 'black'
                            }
                        });
                        map.addSource('us-boundaries-labels', {
                            type: 'geojson',
                            data: labelData
                        });
                        map.addLayer({
                            id: 'us-boundaries-labels-layer',
                            type: 'symbol',
                            source: 'us-boundaries-labels',
                            layout: {
                                'text-field': ['get', 'name'],
                                'text-font': ['Open Sans Bold', 'Arial Unicode MS Bold'],
                                'text-size': 10, // Increased font size
                                'text-transform': 'uppercase', // Changed text to uppercase
                                'text-letter-spacing': 0.05, // Added letter spacing
                                'text-offset': [0, 0.6],
                                'text-anchor': 'top'
                            },
                            paint: {
                                'text-color': 'black',
                                'text-halo-color': 'white', // Added halo color
                                'text-halo-width': 2 // Added halo width
                            }
                        });
                    }
                    document.getElementById('year-label').textContent = `Period: ${year}`;
                })
                .catch(error => console.error('Error loading shapefile:', error));
        }

        map.on('load', () => {
            loadShapefile(1800);

            document.getElementById('slider').addEventListener('input', function () {
                const year = this.value;
                loadShapefile(year);
            });
        });
        
    </script>
    <script src="mapinteraction.js"></script>

</body>
</html>
